\section{Pregunta N$^{\circ}$4\qquad Alejandro Escobar Mejia}

\begin{frame}
	\begin{enumerate}\setcounter{enumi}{3}
		\item

		      Una familia consta de una madre, un padre y una hija.
		      La suma de las edades actuales de los tres es de $80$ años.
		      Dentro de $22$ años, la edad del hijo sería la mitad que la
		      de la madre.
		      Si el padre es un año mayor que la madre.
		      Determinar la edad de la familia según los siguientes
		      requerimientos:

		      \begin{enumerate}[a)]
			      \item

			            Modele el sistema.

			      \item

			            Resuelva el sistema usando el método de relajación
			            y del descenso más rápido.
		      \end{enumerate}
	\end{enumerate}

	\begin{solution}
		\begin{enumerate}[a)]
			\item

			      Sean las edades de la \alert{madre}, del \alert{padre} y
			      del \alert{hijo}: \alert{$x_{1}$}, \alert{$x_{2}$} y
			      \alert{$x_{3}$}, respectivamente.
			      Entonces, el sistema lineal es

			      \begin{equation*}
				      \systeme{
				      x_{1}+x_{2}+x_{3}=80,
				      -x_{1}+x_{2}=1,
				      -x_{1}+2x_{3}=-22
				      }\iff
				      \underbrace{
					      \begin{bmatrix}
						      1  & 1 & 1 \\
						      -1 & 1 & 0 \\
						      -1 & 0 & 2
					      \end{bmatrix}
				      }_{\displaystyle\widehat{A}}
				      \underbrace{
					      \begin{bmatrix}
						      x_{1} \\
						      x_{2} \\
						      x_{3}
					      \end{bmatrix}
				      }_{\displaystyle\widehat{x}}
				      =
				      \underbrace{
					      \begin{bmatrix}
						      80 \\
						      1  \\
						      -22
					      \end{bmatrix}
				      }_{\displaystyle b}.
			      \end{equation*}

			\item

			      Sea
			      \begin{math}
				      P=
				      \begin{bmatrix}
					      e_{1} & e_{3} & e_{2}
				      \end{bmatrix}
			      \end{math}
			      una matriz de permutación,
			      donde
			      \begin{math}
				      \left\{e_{1},e_{2},e_{3}\right\}
			      \end{math}
			      es la base canónica de $\mathbb{R}^{3}$.
			      Entonces,
			      \begin{equation*}
				      \widehat{A}\widehat{x}=
				      \left(
				      \begin{bmatrix}
					      1  & 1 & 1 \\
					      -1 & 1 & 0 \\
					      -1 & 0 & 2
				      \end{bmatrix}
				      \alert{
					      \begin{bmatrix}
						      1 & 0 & 0 \\
						      0 & 0 & 1 \\
						      0 & 1 & 0 \\
					      \end{bmatrix}
				      }
				      \right)
				      \left(
				      \alert{
					      {\begin{bmatrix}
							      1 & 0 & 0 \\
							      0 & 0 & 1 \\
							      0 & 1 & 0 \\
						      \end{bmatrix}}^{T}
				      }
				      \begin{bmatrix}
					      x_{1} \\
					      x_{2} \\
					      x_{3}
				      \end{bmatrix}
				      \right)
				      =
				      \left(\widehat{A}P\right)
				      \left(P^{T}\widehat{x}\right)
				      =
				      \begin{bmatrix}
					      1  & 1 & 1 \\
					      -1 & 0 & 1 \\
					      -1 & 2 & 0
				      \end{bmatrix}
				      \begin{bmatrix}
					      x_{1} \\
					      x_{3} \\
					      x_{2}
				      \end{bmatrix}.
			      \end{equation*}
			      Luego, el sistema equivalente es
			      \begin{equation*}
				      \underbrace{
					      \begin{bmatrix}
						      1  & 1 & 1 \\
						      -1 & 0 & 1 \\
						      -1 & 2 & 0
					      \end{bmatrix}
				      }_{\displaystyle A}
				      \underbrace{
					      \begin{bmatrix}
						      x_{1} \\
						      x_{3} \\
						      x_{2}
					      \end{bmatrix}
				      }_{\displaystyle x}
				      =
				      \underbrace{
					      \begin{bmatrix}
						      80 \\
						      1  \\
						      -22
					      \end{bmatrix}
				      }_{\displaystyle b}.
			      \end{equation*}
		\end{enumerate}
	\end{solution}
\end{frame}

\begin{frame}
	\begin{solution}
		\begin{enumerate}[b)]
			\item

			      En los método de SOR y del descenso más rápido,
			      consideraremos cuando la matriz sea \alert{simétrica} y
			      \alert{definida positiva}, así multiplicamos por
			      $\alert{A^{T}}$.

			      \begin{align*}
				      \alert{A^{T}}Ax=
				      \alert{A^{T}}b \\
				      \alert{
					      {\begin{bmatrix}
								       1  & 1 & 1 \\
								       -1 & 0 & 1 \\
								       -1 & 2 & 0
							       \end{bmatrix}}^{T}
				      }
				      \begin{bmatrix}
					      1  & 1 & 1 \\
					      -1 & 0 & 1 \\
					      -1 & 2 & 0
				      \end{bmatrix}
				      \begin{bmatrix}
					      x_{1} \\
					      x_{3} \\
					      x_{2}
				      \end{bmatrix}=
				      \alert{
					      {\begin{bmatrix}
								       1  & 1 & 1 \\
								       -1 & 0 & 1 \\
								       -1 & 2 & 0
							       \end{bmatrix}}^{T}
				      }
				      \begin{bmatrix}
					      80 \\
					      1  \\
					      -22
				      \end{bmatrix}
				      \\
				      \underbrace{
					      \begin{bmatrix}
						      3  & -1 & 0 \\
						      -1 & 5  & 1 \\
						      0  & 1  & 2
					      \end{bmatrix}
				      }_{\displaystyle \widetilde{A}}
				      \underbrace{
					      \begin{bmatrix}
						      x_{1} \\
						      x_{3} \\
						      x_{2}
					      \end{bmatrix}
				      }_{\displaystyle x}
				      =
				      \underbrace{
					      \begin{bmatrix}
						      101 \\
						      36  \\
						      81
					      \end{bmatrix}
				      }_{\displaystyle \widetilde{b}}.
			      \end{align*}
			      En efecto, $\widetilde{A}$ tiene todos los autovalores
			      \begin{math}
				      \lambda_{1}=1.623,
				      \lambda_{2}=2.726,
				      \lambda_{3}=5.651
			      \end{math}
			      positivos.
			      El método de sobre-relajación sucesiva (SOR) toma la
			      dirección de Gauss-Seidel hacia la solución y
			      ``sobrepasa'' para tratar de acelerar la convergencia.

			      El teorema de \alert{Ostrowoski-Reich} afirma que si
			      $\widetilde{A}$ es simétrica, definida positiva y
			      tridiagonal, la elección óptima del
			      coeficiente de relajación es
			      \begin{equation*}
				      \omega_{\text{opt}}=
				      \dfrac{2}{
				      1+
				      \sqrt{1-{\rho\left(T_{\text{Jac}}\right)}^{2}}
				      }.
			      \end{equation*}
			      donde \begin{math}
				      \rho\left(T_{\text{Jac}}\right)
			      \end{math}
			      es el radio espectral de la matriz de iteración de
			      Jacobi de $\widetilde{A}$.
		\end{enumerate}
	\end{solution}
\end{frame}

\begin{frame}
	\begin{solution}
		\begin{enumerate}[b)]
			\item

			      Calculemos, la matriz de iteración de Jacobi
			      \begin{align*}
				      \widetilde{A}  & =
				      \underbrace{ \begin{bmatrix}
						                   3 & 0 & 0 \\
						                   0 & 5 & 0 \\
						                   0 & 0 & 2
					                   \end{bmatrix}}_{\displaystyle D}
				      -
				      \underbrace{\begin{bmatrix}
						                  0 & 0  & 0 \\
						                  1 & 0  & 0 \\
						                  0 & -1 & 0
					                  \end{bmatrix}}_{\displaystyle L}
				      -
				      \underbrace{\begin{bmatrix}
						                  0 & 1 & 0  \\
						                  0 & 0 & -1 \\
						                  0 & 0 & 0
					                  \end{bmatrix}}_{\displaystyle U}. \\
				      T_{\text{Jac}} & =D^{-1}\left(L+U\right)=
				      \begin{bmatrix}
					      0            & \dfrac{1}{3}  & 0             \\
					      \dfrac{1}{5} & 0             & -\dfrac{1}{5} \\
					      0            & -\dfrac{1}{2} & 0
				      \end{bmatrix}.
			      \end{align*}
			      Así,
			      \begin{math}
				      \rho\left(T_{\text{Jac}}\right)\approx
				      0.4082482904638632<1
			      \end{math}
			      y
			      \begin{math}
				      \omega_{\text{opt}}\approx
				      1.0455488498966778\in\left(0,2\right)
			      \end{math}.

			      De la regla iterativa del método de SOR y parámetro de
			      relajación $\omega_{\text{opt}}$ obtenemos la solución
			      \begin{equation*}
				      x_{i}^{\left(k\right)}=
				      \left(1-\omega_{\text{opt}}\right)
				      x_{i}^{\left(k-1\right)}+
				      \dfrac{\omega_{\text{opt}}}{a_{ii}}
				      \left(
				      b_{i}-
				      \sum\limits_{j=1}^{i-1}
				      a_{ij}x_{j}^{\left(k\right)}-
				      \sum\limits_{j=i+1}^{n}
				      a_{ij}x_{j}^{\left(k-1\right)}
				      \right).
			      \end{equation*}
			      Obtenemos que la edad del \alert{padre es $37$}, de la
			      \alert{madre es $36$} y del \alert{hijo es $7$}.
		\end{enumerate}
	\end{solution}
\end{frame}

\begin{frame}[fragile]
	\begin{columns}
		\begin{column}{0.48\textwidth}
			\inputminted[fontsize=\tiny,firstline=1,lastline=24]{python}{p4_sor.py}
		\end{column}
		\begin{column}{0.48\textwidth}
			\inputminted[fontsize=\tiny,firstline=26,lastline=52]{python}{p4_sor.py}
		\end{column}
	\end{columns}
\end{frame}

\begin{frame}[fragile]
	\begin{columns}
		\begin{column}{0.48\textwidth}
			\inputminted[fontsize=\tiny,firstline=1,lastline=29]{text}{p4_sor.txt}
		\end{column}
		\begin{column}{0.48\textwidth}
			\inputminted[fontsize=\tiny,firstline=30,lastline=53]{text}{p4_sor.txt}
		\end{column}
	\end{columns}
\end{frame}

\begin{frame}
	\begin{solution}
		\begin{enumerate}[b)]
			\item

			      En el método del descenso más rápido, usamos las
			      ecuaciones
			      \begin{align*}
				      v^{\left(k+1\right)} & =
				      r^{\left(k\right)}=
				      b-Ax^{\left(k\right)}.   \\
				      t_{k}                & =
				      \dfrac{
					      \langle
					      v^{\left(k\right)},
					      r^{\left(k-1\right)}
					      \rangle
				      }{
					      \langle
					      v^{\left(k\right)},
					      Av^{\left(k\right)}
					      \rangle
				      }=
				      \dfrac{
				      \left(v^{\left(k\right)}\right)^{T}r^{\left(k-1\right)}
				      }{
				      \left(v^{\left(k\right)}\right)^{T}Av^{\left(k\right)}
				      }.                       \\
				      x^{\left(k\right)}   & =
				      x^{\left(k-1\right)}+
				      t_{k}v^{\left(k\right)}.
			      \end{align*}

			      En la iteración $k=1$ tenemos
			      \begin{align*}
				      v^{\left(1\right)} & =
				      r^{\left(0\right)}=
				      b-Ax^{\left(0\right)}=
				      \begin{bmatrix}
					      101 \\
					      81  \\
					      36
				      \end{bmatrix}.         \\
				      t_{1}              & =
				      0.37.                  \\
				      x^{\left(1\right)} & =
				      x^{\left(0\right)}+
				      t_{1}v^{\left(1\right)}=
				      \begin{bmatrix}
					      37.40 \\
					      29.99 \\
					      13.33
				      \end{bmatrix}.
			      \end{align*}

			      Y así, hasta encontrar la solución y esta se da en la
			      iteración
			      $k=35$:
			      \begin{equation*}
				      x^{\left(35\right)}=
				      \begin{bmatrix}
					      36 \\
					      37 \\
					      7
				      \end{bmatrix}.
			      \end{equation*}
		\end{enumerate}
	\end{solution}
\end{frame}

\begin{frame}[fragile]
	\begin{columns}
		\begin{column}{0.48\textwidth}
			\inputminted[fontsize=\tiny,firstline=1,lastline=24]{python}{p4_steepest.py}
		\end{column}
		\begin{column}{0.48\textwidth}
			\inputminted[fontsize=\tiny,firstline=27,lastline=52]{python}{p4_steepest.py}
		\end{column}
	\end{columns}
\end{frame}

\begin{frame}[fragile]
	\begin{columns}
		\begin{column}{0.48\textwidth}
			\inputminted[fontsize=\tiny,firstline=1,lastline=39]{text}{p4_steepest.txt}
		\end{column}
		\begin{column}{0.48\textwidth}
			\inputminted[fontsize=\tiny,firstline=40,lastline=78]{text}{p4_steepest.txt}
		\end{column}
	\end{columns}
\end{frame}

\begin{frame}[fragile]
	\begin{columns}
		\begin{column}{0.48\textwidth}
			\inputminted[fontsize=\tiny,firstline=80,lastline=118]{text}{p4_steepest.txt}
		\end{column}
		\begin{column}{0.48\textwidth}
			\inputminted[fontsize=\tiny,firstline=120,lastline=158]{text}{p4_steepest.txt}
		\end{column}
	\end{columns}
\end{frame}